### 0、导数

- 菜单页（看每日工作状态的导数）luckin_shops_product.ktr
- 店铺搜索页（每月+每周一爬）luckin_shops_new.ktr
- 遍历接口（每月+每周一爬）luckin_shops_detail_all.ktr
- 遍历接口线下门店（每日一爬）luckin_shops_detail_offline.ktr

### 1、上传月报

```sql
--环境：GP
--更新城市匹配表
insert into luckin.dw_shop_city
select distinct on(deptid::text)deptid::text,cityname from luckin.ods_shops_new where deptid::text not in (select shopid::text from luckin.dw_shop_city) and cityname!='' and cityname is not null;
insert into luckin.dw_shop_city
select distinct on(shopid::text)shopid::text,cityname from luckin.ods_shops_detail where shopid::text not in (select shopid::text from luckin.dw_shop_city) and cityname!='' and cityname is not null;
--检查是否还要有当月店铺没匹配到城市
select distinct on (deptid) deptid::text, latitude, longitude
    from luckin.ods_shops_new
    where ts_string = '2020-04-01'
      and deptid::text not in (select shopid::text from luckin.dw_shop_city);
--计算月度城市的店铺数
with t as (
select distinct on(deptid)deptid::text as shopid,length(address)>8  as isopened ,j1.cityname from luckin.ods_shops_new j2
left join luckin.dw_shop_city j1 on j1.shopid=j2.deptid::text
where ts_string='2020-04-01'
) ,
     t1 as (
select field_name as pname,* from t x
--select distinct on(cityname)cityname,city from luckin.ods_shops_new x
left join
(select  city,city_normalized,field_name from  luckin.city_tier x1 left join luckin.luckin_field_map x2 on regexp_replace(x1.city_normalized,'(\(|（| )+.*','')=regexp_replace(x2.field_text,'(\(|（| )+.*','')
) y
on decode(x.cityname,'江阴','无锡','英德','清远','都江堰','成都',x.cityname)=replace(y.city,'市','')
),--select * from t1 left join (select distinct on(shopid)shopid,gcjlat,gcjlon from luckin.ods_shops_detail)jx using(shopid) where pname is null;,
t3 as (
select count(*) as cnt,pname,isopened from t1 group by pname,isopened
),
t4 as (
select 
case when isopened is true then pname
else  pname||'_r' end as ppname,
cnt from t3
)
select * from t4;
--得到的数据更新到dashboard
--环境mysql
update common_ticker.luckin_data_monthly
set
Zunyi=3,Zigong_r=3,Zigong=1,Zibo_r=2,Zibo=5,Zhuzhou_r=2,Zhuzhou=5,Zhuhai_r=6,Zhuhai=28,Zhoushan_r=3,Zhoushan=1,Zhoukou=1,Zhongshan_r=3,Zhongshan=18,Zhenjiang_r=3,Zhenjiang=26,Zhengzhou_r=8,Zhengzhou=94,Zhaoqing_r=2,Zhaoqing=1,Zhangzhou_r=3,Zhangzhou=3,Zhangjiang_r=4,Zhangjiang=4,Zhangjiakou_r=2,Zhangjiakou=1,Zaozhuang_r=2,Zaozhuang=1,Yuxi=1,Yunfu=1,Yuncheng_r=1,Yuncheng=1,Yueyang=1,Yingkou_r=1,Yingkou=1,Yichang_r=1,Yichang=3,Yibin=1,Yantai_r=2,Yantai=4,Yangzhou_r=3,Yangzhou=29,Yangjiang_r=4,Yangjiang=1,Yancheng_r=2,Yancheng=4,Xuzhou_r=11,Xuzhou=11,Xuchang=1,Xuancheng=1,Xinzhou=1,Xinyu_r=1,Xinyu=1,Xinyang=2,Xingtai_r=3,Xingtai=1,Xiaogan=2,Xianyang=9,Xianning=1,Xiangyang_r=1,Xiangyang=7,Xiangtan_r=2,Xiangtan=3,Xiamen_r=2,Xiamen=97,Xi_an_r=13,Xi_an=133,Wuxi_r=5,Wuxi=106,Wuhu_r=1,Wuhu=5,Wuhan_r=23,Wuhan=184,Wenzhou_r=20,Wenzhou=57,Weihai_r=1,Weihai=2,Weifang_r=3,Weifang=5,Tongren=1,Tongling=2,Tianjin_r=28,Tianjin=161,Tangshan_r=1,Tangshan=2,Taizhou_zhejiang_r=14,Taizhou_zhejiang=14,Taizhou_jiangsu_r=5,Taizhou_jiangsu=5,Taiyuan_r=8,Taiyuan=26,Suzhou_jiangsu_r=26,Suzhou_jiangsu=127,Suqian_r=2,Suqian=5,Suining_r=1,Suining=1,Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture=2,Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture=1,Shijiazhuang_r=16,Shijiazhuang=39,Shenzhen_r=30,Shenzhen=244,Shenyang_r=18,Shenyang=56,Shaoxing_r=6,Shaoxing=33,Shanwei=1,Shantou_r=3,Shangrao_r=5,Shangrao=2,Shanghai_r=56,Shanghai=524,Sanming_r=1,Sanming=3,Quanzhou_r=12,Quanzhou=45,Qiqihar=1,Qinhuangdao_r=3,Qinhuangdao=1,Qingyuan=2,Qingdao_r=10,Qingdao=80,Puyang_r=1,Puyang=1,Putian_r=4,Putian=3,Ningde=1,Ningbo_r=25,Ningbo=114,Nanyang_r=1,Nanyang=1,Nantong_r=9,Nantong=36,Nanning_r=9,Nanning=34,Nanjing_r=14,Nanjing=226,Nanchong_r=2,Nanchong=1,Nanchang_r=16,Nanchang=49,Mudanjiang_r=1,Mudanjiang=1,Mianyang_r=5,Mianyang=1,Maanshan=2,Luoyang_r=2,Luoyang=1,Luohe=2,Luliang=1,Longyan_r=1,Longyan=4,Lishui_r=11,Lishui=1,Linyi_r=10,Linyi=1,Linfen_r=1,Linfen=1,Lijiang=1,Liaocheng_r=1,Liaocheng=1,Lianyungang_r=1,Lianyungang=2,Liangshan_Yi_Autonomous_Prefecture=1,Leshan_r=4,Leshan=1,Lanzhou_r=5,Lanzhou=19,Langfang_r=5,Langfang=2,Kunming_r=17,Kunming=61,Jiujiang_r=2,Jiujiang=1,Jinzhou=2,Jinzhong=6,Jining=1,Jinhua_r=20,Jinhua=7,Jingzhou=2,Jingdezhen_r=3,Jingdezhen=1,Jinan_r=6,Jinan=64,Jieyang_r=2,Jiaxing_r=10,Jiaxing=32,Jiangmen=2,Huzhou_r=10,Huzhou=5,Huizhou_r=10,Huizhou=3,Huangshan_r=1,Huanggang=2,Huaibei=2,Huaian_r=6,Huaian=5,Hohhot_r=1,Hengyang=1,Hengshui=1,Hefei_r=10,Hefei=69,Harbin_r=4,Harbin=20,Haozhou_r=2,Haozhou=2,Hanzhong_r=1,Hanzhong=1,Hangzhou_r=30,Hangzhou=233,Handan_r=1,Handan=2,Haikou_r=4,Haikou=18,Guiyang_r=5,Guiyang=49,Guilin=1,Guangzhou_r=50,Guangzhou=260,Ganzhou_r=7,Ganzhou=6,Fuzhou_fujian_r=8,Fuzhou_fujian=94,Fuyang_r=1,Fuyang=3,Foshan_r=9,Foshan=50,Ezhou_r=1,Ezhou=1,Dongguan_r=13,Dongguan=36,Dezhou=2,Deyang_r=3,Deyang=2,Dalian_r=4,Dalian=66,Dali_Bai_Autonomous_Prefecture=1,Chongqing_r=12,Chongqing=167,Chenzhou=1,Chengdu_r=26,Chengdu=204,Chengde_r=2,Chengde=2,Chaozhou=1,Changzhou_r=5,Changzhou=47,Changsha_r=16,Changsha=120,Changde=4,Changchun_r=6,Changchun=5,Cangzhou_r=1,Cangzhou=3,Binzhou=1,Bengbu_r=3,Bengbu=2,Beijing_r=61,Beijing=415,Bazhong=1,Baoji_r=3,Baoji=6,Baoding_r=4,Baoding=5,Anshan_r=1,Anshan=1
where ts='2020-03';
--计算省份数据
with t as (
-- select  distinct on (shopid)shopid,cityname,length(address)>8  as isopened from luckin.ods_shops_detail where ts_string='2019-12-30' and shopid in (select * from luckin.ods_ids)
      select distinct on(deptid)deptid::text as shopid,length(address)>8  as isopened ,j1.cityname from luckin.ods_shops_new j2
left join luckin.dw_shop_city j1 on j1.shopid=j2.deptid::text
where ts_string='2020-04-01'
),t1 as (
select field_name as pname,* from t x
--select distinct on(cityname)cityname,city from luckin.ods_shops_new x
left join
(select  city,city_normalized,field_name from  luckin.city_tier x1 left join luckin.luckin_field_map x2 on regexp_replace(x1.city_normalized,'(\(|（| )+.*','')=regexp_replace(x2.field_text,'(\(|（| )+.*','')
) y 
on decode(x.cityname,'江阴','无锡','英德','清远','都江堰','成都',x.cityname)=replace(y.city,'市','')  
),
t2 as (
select x.pname from t1 left join p_city_map x on 
t1.cityname=replace(x.cityname,'市','')
where isopened is true 
),
t3 as (
select pname,count(*)as cnt from t2 group by pname
)
select 
p_prov,cnt from t3 left join luckin.prov_pinyin xxx on substring(t3.pname,1,2)=substring(xxx.prov_name,1,2) where pname not like '%市';



--更新到mysql
update common_ticker.luckin_data_monthly
set
Zhejiang=497,Yunnan=64,Sichuan=214,Shanxi=36,Shandong=167,Shaanxi=149,Liaoning=126,Jilin=5,Jiangxi=60,Jiangsu=628,Hunan=135,Hubei=202,Henan=103,Heilongjiang=22,Hebei=59,Hainan=18,Guizhou=56,Guangxi=35,Guangdong=652,Gansu=19,Fujian=250,Anhui=88
where ts='2020-03';




--更新null为0
update common_ticker.luckin_data_monthly 
set 
ts=coalesce(ts,0),total_store_cnt=coalesce(total_store_cnt,0),total_store_cnt_r=coalesce(total_store_cnt_r,0),first_tier=coalesce(first_tier,0),new_first_tier=coalesce(new_first_tier,0),second_tier=coalesce(second_tier,0),third_tier=coalesce(third_tier,0),fourth_tier=coalesce(fourth_tier,0),fifth_tier=coalesce(fifth_tier,0),first_tier_r=coalesce(first_tier_r,0),new_first_tier_r=coalesce(new_first_tier_r,0),second_tier_r=coalesce(second_tier_r,0),third_tier_r=coalesce(third_tier_r,0),fourth_tier_r=coalesce(fourth_tier_r,0),fifth_tier_r=coalesce(fifth_tier_r,0),Beijing=coalesce(Beijing,0),Shanghai=coalesce(Shanghai,0),Guangzhou=coalesce(Guangzhou,0),Shenzhen=coalesce(Shenzhen,0),Chengdu=coalesce(Chengdu,0),Chongqing=coalesce(Chongqing,0),Hangzhou=coalesce(Hangzhou,0),Suzhou_jiangsu=coalesce(Suzhou_jiangsu,0),Wuhan=coalesce(Wuhan,0),Nanjing=coalesce(Nanjing,0),Tianjin=coalesce(Tianjin,0),Zhengzhou=coalesce(Zhengzhou,0),Changsha=coalesce(Changsha,0),Shenyang=coalesce(Shenyang,0),Dongguan=coalesce(Dongguan,0),Hefei=coalesce(Hefei,0),Changchun=coalesce(Changchun,0),Kunming=coalesce(Kunming,0),Xi_an=coalesce(Xi_an,0),Wuxi=coalesce(Wuxi,0),Harbin=coalesce(Harbin,0),Foshan=coalesce(Foshan,0),Fuzhou_fujian=coalesce(Fuzhou_fujian,0),Ningbo=coalesce(Ningbo,0),Jinan=coalesce(Jinan,0),Nanchang=coalesce(Nanchang,0),Qingdao=coalesce(Qingdao,0),Jinhua=coalesce(Jinhua,0),Nanning=coalesce(Nanning,0),Dalian=coalesce(Dalian,0),Hohhot=coalesce(Hohhot,0),Huizhou=coalesce(Huizhou,0),Zhongshan=coalesce(Zhongshan,0),Shijiazhuang=coalesce(Shijiazhuang,0),Taizhou_zhejiang=coalesce(Taizhou_zhejiang,0),Guiyang=coalesce(Guiyang,0),Xiamen=coalesce(Xiamen,0),Haikou=coalesce(Haikou,0),Quanzhou=coalesce(Quanzhou,0),Changzhou=coalesce(Changzhou,0),Xuzhou=coalesce(Xuzhou,0),Taiyuan=coalesce(Taiyuan,0),Nantong=coalesce(Nantong,0),Zhuhai=coalesce(Zhuhai,0),Tangshan=coalesce(Tangshan,0),Jilin=coalesce(Jilin,0),Jiaxing=coalesce(Jiaxing,0),Wenzhou=coalesce(Wenzhou,0),Langfang=coalesce(Langfang,0),Shaoxing=coalesce(Shaoxing,0),Baoding=coalesce(Baoding,0),Urumqi=coalesce(Urumqi,0),Shantou=coalesce(Shantou,0),Wuhu=coalesce(Wuhu,0),Linyi=coalesce(Linyi,0),Luoyang=coalesce(Luoyang,0),Guilin=coalesce(Guilin,0),Lanzhou=coalesce(Lanzhou,0),Yangzhou=coalesce(Yangzhou,0),Jiangmen=coalesce(Jiangmen,0),Huzhou=coalesce(Huzhou,0),Qinhuangdao=coalesce(Qinhuangdao,0),Mianyang=coalesce(Mianyang,0),Weifang=coalesce(Weifang,0),Yantai=coalesce(Yantai,0),Zhenjiang=coalesce(Zhenjiang,0),Anshan=coalesce(Anshan,0),Liuzhou=coalesce(Liuzhou,0),Yancheng=coalesce(Yancheng,0),Yanbian_Korean_Autonomous_Prefecture=coalesce(Yanbian_Korean_Autonomous_Prefecture,0),Huaian=coalesce(Huaian,0),Baotou=coalesce(Baotou,0),Hengyang=coalesce(Hengyang,0),Zhangzhou=coalesce(Zhangzhou,0),Yichang=coalesce(Yichang,0),Zhangjiang=coalesce(Zhangjiang,0),Taizhou_jiangsu=coalesce(Taizhou_jiangsu,0),Ganzhou=coalesce(Ganzhou,0),Xinxiang=coalesce(Xinxiang,0),Qiqihar=coalesce(Qiqihar,0),Zibo=coalesce(Zibo,0),Sanya=coalesce(Sanya,0),Zhuzhou=coalesce(Zhuzhou,0),Jining=coalesce(Jining,0),Shangqiu=coalesce(Shangqiu,0),Yinchuan=coalesce(Yinchuan,0),Dali_Bai_Autonomous_Prefecture=coalesce(Dali_Bai_Autonomous_Prefecture,0),Jinzhou=coalesce(Jinzhou,0),Zhaoqing=coalesce(Zhaoqing,0),Daqing=coalesce(Daqing,0),Yueyang=coalesce(Yueyang,0),Lianyungang=coalesce(Lianyungang,0),Xining=coalesce(Xining,0),Xianyang=coalesce(Xianyang,0),Dandong=coalesce(Dandong,0),Tongliao=coalesce(Tongliao,0),Changde=coalesce(Changde,0),Zunyi=coalesce(Zunyi,0),Nanyang=coalesce(Nanyang,0),Putian=coalesce(Putian,0),Suqian=coalesce(Suqian,0),Chifeng=coalesce(Chifeng,0),Jiujiang=coalesce(Jiujiang,0),Cangzhou=coalesce(Cangzhou,0),Nanchong=coalesce(Nanchong,0),Handan=coalesce(Handan,0),Yingkou=coalesce(Yingkou,0),Fuyang=coalesce(Fuyang,0),Xinyang=coalesce(Xinyang,0),Weihai=coalesce(Weihai,0),Hulunbeir=coalesce(Hulunbeir,0),Deyang=coalesce(Deyang,0),Xiangtan=coalesce(Xiangtan,0),Maanshan=coalesce(Maanshan,0),Anqing=coalesce(Anqing,0),Luzhou=coalesce(Luzhou,0),Panjin=coalesce(Panjin,0),Yibin=coalesce(Yibin,0),Shangrao=coalesce(Shangrao,0),Xiangyang=coalesce(Xiangyang,0),Quzhou=coalesce(Quzhou,0),Yuncheng=coalesce(Yuncheng,0),Lu_an=coalesce(Lu_an,0),Bengbu=coalesce(Bengbu,0),Jingzhou=coalesce(Jingzhou,0),Kaifeng=coalesce(Kaifeng,0),Zhoukou=coalesce(Zhoukou,0),Leshan=coalesce(Leshan,0),Tai_an=coalesce(Tai_an,0),Chuzhou=coalesce(Chuzhou,0),Xuchang=coalesce(Xuchang,0),Huludao=coalesce(Huludao,0),Fushun=coalesce(Fushun,0),Siping=coalesce(Siping,0),Zhumadian=coalesce(Zhumadian,0),Jieyang=coalesce(Jieyang,0),Qingyuan=coalesce(Qingyuan,0),Suihua=coalesce(Suihua,0),Huanggang=coalesce(Huanggang,0),Zhangjiakou=coalesce(Zhangjiakou,0),Huaihua=coalesce(Huaihua,0),Xiaogan=coalesce(Xiaogan,0),Maoming=coalesce(Maoming,0),Anyang=coalesce(Anyang,0),Tieling=coalesce(Tieling,0),Datong=coalesce(Datong,0),Liaoyang=coalesce(Liaoyang,0),Beihai=coalesce(Beihai,0),Lishui=coalesce(Lishui,0),Jiaozuo=coalesce(Jiaozuo,0),Heze=coalesce(Heze,0),Chenzhou=coalesce(Chenzhou,0),Honghe_Hani_and_Yi_Autonomous_Prefecture=coalesce(Honghe_Hani_and_Yi_Autonomous_Prefecture,0),Longyan=coalesce(Longyan,0),Songyuan=coalesce(Songyuan,0),Xingtai=coalesce(Xingtai,0),Ningde=coalesce(Ningde,0),Chaozhou=coalesce(Chaozhou,0),Qujing=coalesce(Qujing,0),Chengde=coalesce(Chengde,0),Liaocheng=coalesce(Liaocheng,0),Pingdingshan=coalesce(Pingdingshan,0),Nanping=coalesce(Nanping,0),Yangjiang=coalesce(Yangjiang,0),Suining=coalesce(Suining,0),Shaoyang=coalesce(Shaoyang,0),Shaoguan=coalesce(Shaoguan,0),Meizhou=coalesce(Meizhou,0),Jinzhong=coalesce(Jinzhong,0),Rizhao=coalesce(Rizhao,0),Lhasa=coalesce(Lhasa,0),Yichun_jiangxi=coalesce(Yichun_jiangxi,0),Dezhou=coalesce(Dezhou,0),Dongying=coalesce(Dongying,0),Yongzhou=coalesce(Yongzhou,0),Chaoyang=coalesce(Chaoyang,0),Tonghua=coalesce(Tonghua,0),Meishan=coalesce(Meishan,0),Minnan_Buyi_and_Miao_Autonomous_Prefecture=coalesce(Minnan_Buyi_and_Miao_Autonomous_Prefecture,0),Yulin_shanxi=coalesce(Yulin_shanxi,0),Mudanjiang=coalesce(Mudanjiang,0),Haozhou=coalesce(Haozhou,0),Luohe=coalesce(Luohe,0),Jiamusi=coalesce(Jiamusi,0),Yiyang=coalesce(Yiyang,0),Yuxi=coalesce(Yuxi,0),Linfen=coalesce(Linfen,0),Weinan=coalesce(Weinan,0),Ji_an=coalesce(Ji_an,0),Baicheng=coalesce(Baicheng,0),Xuancheng=coalesce(Xuancheng,0),Benxi=coalesce(Benxi,0),Baoji=coalesce(Baoji,0),Liangshan_Yi_Autonomous_Prefecture=coalesce(Liangshan_Yi_Autonomous_Prefecture,0),Shanwei=coalesce(Shanwei,0),Sanming=coalesce(Sanming,0),Neijiang=coalesce(Neijiang,0),Jingmen=coalesce(Jingmen,0),Suzhou_anhui=coalesce(Suzhou_anhui,0),Tongren=coalesce(Tongren,0),Bayin_Guoyu_Mongolian_Autonomous_Prefecture=coalesce(Bayin_Guoyu_Mongolian_Autonomous_Prefecture,0),Fuzhou_jiangxi=coalesce(Fuzhou_jiangxi,0),Xiangxi_Tujia_and_Miao_Autonomous_Prefecture=coalesce(Xiangxi_Tujia_and_Miao_Autonomous_Prefecture,0),Dazhou=coalesce(Dazhou,0),Xing_an_League=coalesce(Xing_an_League,0),Loudi=coalesce(Loudi,0),Zaozhuang=coalesce(Zaozhuang,0),Anshun=coalesce(Anshun,0),Huangshan=coalesce(Huangshan,0),Ordos=coalesce(Ordos,0),Hanzhong=coalesce(Hanzhong,0),Huangshi=coalesce(Huangshi,0),Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture=coalesce(Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture,0),Fuxin=coalesce(Fuxin,0),Yulin_guangxi=coalesce(Yulin_guangxi,0),Baishan=coalesce(Baishan,0),Xianning=coalesce(Xianning,0),Puyang=coalesce(Puyang,0),Binzhou=coalesce(Binzhou,0),Lijiang=coalesce(Lijiang,0),Bijie=coalesce(Bijie,0),Changji_Hui_Autonomous_Prefecture=coalesce(Changji_Hui_Autonomous_Prefecture,0),Zigong=coalesce(Zigong,0),Wuzhou=coalesce(Wuzhou,0),Chizhou=coalesce(Chizhou,0),Tongling=coalesce(Tongling,0),Wenshan_Zhuang_and_Miao_Autonomous_Prefecture=coalesce(Wenshan_Zhuang_and_Miao_Autonomous_Prefecture,0),Hengshui=coalesce(Hengshui,0),Pu_er=coalesce(Pu_er,0),Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture=coalesce(Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture,0),Huaibei=coalesce(Huaibei,0),Baise=coalesce(Baise,0),Heyuan=coalesce(Heyuan,0),Enshi_Tujia_and_Miao_Autonomous_Prefecture=coalesce(Enshi_Tujia_and_Miao_Autonomous_Prefecture,0),Huainan=coalesce(Huainan,0),Bayannaoer=coalesce(Bayannaoer,0),Shiyan=coalesce(Shiyan,0),Xilin_Gol_League=coalesce(Xilin_Gol_League,0),Ziyang=coalesce(Ziyang,0),Bazhong=coalesce(Bazhong,0),Zhoushan=coalesce(Zhoushan,0),Jingdezhen=coalesce(Jingdezhen,0),Qinzhou=coalesce(Qinzhou,0),Sanmenxia=coalesce(Sanmenxia,0),Changzhi=coalesce(Changzhi,0),Wulanchabu=coalesce(Wulanchabu,0),Linzhi=coalesce(Linzhi,0),Zhaotong=coalesce(Zhaotong,0),Liupanshui=coalesce(Liupanshui,0),Shihezi=coalesce(Shihezi,0),Zhangjiajie=coalesce(Zhangjiajie,0),Guangyuan=coalesce(Guangyuan,0),Chuxiong_Yi_Autonomous_Prefecture=coalesce(Chuxiong_Yi_Autonomous_Prefecture,0),Ankang=coalesce(Ankang,0),Ili_Kazakh_Autonomous_Prefecture=coalesce(Ili_Kazakh_Autonomous_Prefecture,0),Jixi=coalesce(Jixi,0),Yunfu=coalesce(Yunfu,0),Jiuquan=coalesce(Jiuquan,0),Wuzhong=coalesce(Wuzhong,0),Dehong_Dai_Jingpo_Autonomous_Prefecture=coalesce(Dehong_Dai_Jingpo_Autonomous_Prefecture,0),Baoshan=coalesce(Baoshan,0),Luliang=coalesce(Luliang,0),Aksu_area=coalesce(Aksu_area,0),Hechi=coalesce(Hechi,0),Guigang=coalesce(Guigang,0),Guang_an=coalesce(Guang_an,0),Xinzhou=coalesce(Xinzhou,0),Xishuangbanna_Dai_Autonomous_Prefecture=coalesce(Xishuangbanna_Dai_Autonomous_Prefecture,0),Heihe=coalesce(Heihe,0),Yan_an=coalesce(Yan_an,0),Xinyu=coalesce(Xinyu,0),Chongzuo=coalesce(Chongzuo,0),Panzhihua=coalesce(Panzhihua,0),Ezhou=coalesce(Ezhou,0),Fangchenggang=coalesce(Fangchenggang,0),Hebi=coalesce(Hebi,0),Yangquan=coalesce(Yangquan,0),Ya_an=coalesce(Ya_an,0),Wuhai=coalesce(Wuhai,0),Jincheng=coalesce(Jincheng,0),Liaoyuan=coalesce(Liaoyuan,0),Shuangyashan=coalesce(Shuangyashan,0),Danzhou=coalesce(Danzhou,0),Yingtan=coalesce(Yingtan,0),Pingxiang=coalesce(Pingxiang,0),Hami=coalesce(Hami,0),Karamay=coalesce(Karamay,0),Lincang=coalesce(Lincang,0),Suizhou=coalesce(Suizhou,0),Shuozhou=coalesce(Shuozhou,0),Tacheng_area=coalesce(Tacheng_area,0),Dingxi=coalesce(Dingxi,0),Kashgar=coalesce(Kashgar,0),Qionghai=coalesce(Qionghai,0),Yichun_heilongjiang=coalesce(Yichun_heilongjiang,0),Laibin=coalesce(Laibin,0),Tianshui=coalesce(Tianshui,0),Laiwu=coalesce(Laiwu,0),Hezhou=coalesce(Hezhou,0),Qingyang=coalesce(Qingyang,0),Qitaihe=coalesce(Qitaihe,0),Shizuishan=coalesce(Shizuishan,0),Jiayuguan=coalesce(Jiayuguan,0),Xiantao=coalesce(Xiantao,0),Bortala_Mongolian_Autonomous_Prefecture=coalesce(Bortala_Mongolian_Autonomous_Prefecture,0),Wuwei=coalesce(Wuwei,0),Haixi_Mongolian_Tibetan_Autonomous_Prefecture=coalesce(Haixi_Mongolian_Tibetan_Autonomous_Prefecture,0),Pingliang=coalesce(Pingliang,0),Tulufan=coalesce(Tulufan,0),Baiyin=coalesce(Baiyin,0),Zhongwei=coalesce(Zhongwei,0),Tianmen=coalesce(Tianmen,0),Shangluo=coalesce(Shangluo,0),Haidong=coalesce(Haidong,0),Jiyuan=coalesce(Jiyuan,0),Qianjiang=coalesce(Qianjiang,0),Linxia_Hui_Autonomous_Prefecture=coalesce(Linxia_Hui_Autonomous_Prefecture,0),Longnan=coalesce(Longnan,0),Aba_Tibetan_and_Qiang_Autonomous_Prefecture=coalesce(Aba_Tibetan_and_Qiang_Autonomous_Prefecture,0),Jinchang=coalesce(Jinchang,0),Zhangye=coalesce(Zhangye,0),Guyuan=coalesce(Guyuan,0),Alxa_League=coalesce(Alxa_League,0),Rikaze=coalesce(Rikaze,0),Hegang=coalesce(Hegang,0),Dongfang=coalesce(Dongfang,0),Wenchang=coalesce(Wenchang,0),Hotan_area=coalesce(Hotan_area,0),Wanning=coalesce(Wanning,0),Diqing_Tibetan_Autonomous_Prefecture=coalesce(Diqing_Tibetan_Autonomous_Prefecture,0),Ganzi_Tibetan_Autonomous_Prefecture=coalesce(Ganzi_Tibetan_Autonomous_Prefecture,0),Linshui_Lizu_Autonomous_Prefecture=coalesce(Linshui_Lizu_Autonomous_Prefecture,0),Shannan=coalesce(Shannan,0),Hainan_Tibetan_Autonomous_Prefecture=coalesce(Hainan_Tibetan_Autonomous_Prefecture,0),Tongchuan=coalesce(Tongchuan,0),Altay_area=coalesce(Altay_area,0),Changjiang_Lizu_Autonomus_Prefecture=coalesce(Changjiang_Lizu_Autonomus_Prefecture,0),Chengmai=coalesce(Chengmai,0),Changdu=coalesce(Changdu,0),Alaer=coalesce(Alaer,0),Nagqu_area=coalesce(Nagqu_area,0),Wujiaqu=coalesce(Wujiaqu,0),Nujiang_Yi_Autonomous_Prefecture=coalesce(Nujiang_Yi_Autonomous_Prefecture,0),Beitun=coalesce(Beitun,0),Kizilsu_Kirghiz_Autonomous_Prefecture=coalesce(Kizilsu_Kirghiz_Autonomous_Prefecture,0),Ledong_Lizu_Autonomous_Prefecture=coalesce(Ledong_Lizu_Autonomous_Prefecture,0),Ali_area=coalesce(Ali_area,0),Lingao=coalesce(Lingao,0),Daxinganling_area=coalesce(Daxinganling_area,0),Wuzhishan=coalesce(Wuzhishan,0),Gannan_Tibetan_Autonomous_Prefecture=coalesce(Gannan_Tibetan_Autonomous_Prefecture,0),Qiongzhong_Lizu_Miaozu_Autonomous_Prefecture=coalesce(Qiongzhong_Lizu_Miaozu_Autonomous_Prefecture,0),Baoting_Lizu_Miaozu_Autonomous_Prefecture=coalesce(Baoting_Lizu_Miaozu_Autonomous_Prefecture,0),Tunchang=coalesce(Tunchang,0),Huangnan_Tibetan_Autonomous_Prefecture=coalesce(Huangnan_Tibetan_Autonomous_Prefecture,0),Anding=coalesce(Anding,0),Yushu_Tibetan_Autonomous_Prefecture=coalesce(Yushu_Tibetan_Autonomous_Prefecture,0),Basha_Lizu_Autonomous_Prefecture=coalesce(Basha_Lizu_Autonomous_Prefecture,0),Haibei_Tibetan_Autonomous_Prefecture=coalesce(Haibei_Tibetan_Autonomous_Prefecture,0),Shennongjia_Forrest=coalesce(Shennongjia_Forrest,0),shuanghe=coalesce(shuanghe,0),xinjiang_autonomous_districts=coalesce(xinjiang_autonomous_districts,0),Beijing_r=coalesce(Beijing_r,0),Shanghai_r=coalesce(Shanghai_r,0),Guangzhou_r=coalesce(Guangzhou_r,0),Shenzhen_r=coalesce(Shenzhen_r,0),Chengdu_r=coalesce(Chengdu_r,0),Chongqing_r=coalesce(Chongqing_r,0),Hangzhou_r=coalesce(Hangzhou_r,0),Suzhou_jiangsu_r=coalesce(Suzhou_jiangsu_r,0),Wuhan_r=coalesce(Wuhan_r,0),Nanjing_r=coalesce(Nanjing_r,0),Tianjin_r=coalesce(Tianjin_r,0),Zhengzhou_r=coalesce(Zhengzhou_r,0),Changsha_r=coalesce(Changsha_r,0),Shenyang_r=coalesce(Shenyang_r,0),Dongguan_r=coalesce(Dongguan_r,0),Hefei_r=coalesce(Hefei_r,0),Changchun_r=coalesce(Changchun_r,0),Kunming_r=coalesce(Kunming_r,0),Xi_an_r=coalesce(Xi_an_r,0),Wuxi_r=coalesce(Wuxi_r,0),Harbin_r=coalesce(Harbin_r,0),Foshan_r=coalesce(Foshan_r,0),Fuzhou_fujian_r=coalesce(Fuzhou_fujian_r,0),Ningbo_r=coalesce(Ningbo_r,0),Jinan_r=coalesce(Jinan_r,0),Nanchang_r=coalesce(Nanchang_r,0),Qingdao_r=coalesce(Qingdao_r,0),Jinhua_r=coalesce(Jinhua_r,0),Nanning_r=coalesce(Nanning_r,0),Dalian_r=coalesce(Dalian_r,0),Hohhot_r=coalesce(Hohhot_r,0),Huizhou_r=coalesce(Huizhou_r,0),Zhongshan_r=coalesce(Zhongshan_r,0),Shijiazhuang_r=coalesce(Shijiazhuang_r,0),Taizhou_zhejiang_r=coalesce(Taizhou_zhejiang_r,0),Guiyang_r=coalesce(Guiyang_r,0),Xiamen_r=coalesce(Xiamen_r,0),Haikou_r=coalesce(Haikou_r,0),Quanzhou_r=coalesce(Quanzhou_r,0),Changzhou_r=coalesce(Changzhou_r,0),Xuzhou_r=coalesce(Xuzhou_r,0),Taiyuan_r=coalesce(Taiyuan_r,0),Nantong_r=coalesce(Nantong_r,0),Zhuhai_r=coalesce(Zhuhai_r,0),Tangshan_r=coalesce(Tangshan_r,0),Jilin_r=coalesce(Jilin_r,0),Jiaxing_r=coalesce(Jiaxing_r,0),Wenzhou_r=coalesce(Wenzhou_r,0),Langfang_r=coalesce(Langfang_r,0),Shaoxing_r=coalesce(Shaoxing_r,0),Baoding_r=coalesce(Baoding_r,0),Urumqi_r=coalesce(Urumqi_r,0),Shantou_r=coalesce(Shantou_r,0),Wuhu_r=coalesce(Wuhu_r,0),Linyi_r=coalesce(Linyi_r,0),Luoyang_r=coalesce(Luoyang_r,0),Guilin_r=coalesce(Guilin_r,0),Lanzhou_r=coalesce(Lanzhou_r,0),Yangzhou_r=coalesce(Yangzhou_r,0),Jiangmen_r=coalesce(Jiangmen_r,0),Huzhou_r=coalesce(Huzhou_r,0),Qinhuangdao_r=coalesce(Qinhuangdao_r,0),Mianyang_r=coalesce(Mianyang_r,0),Weifang_r=coalesce(Weifang_r,0),Yantai_r=coalesce(Yantai_r,0),Zhenjiang_r=coalesce(Zhenjiang_r,0),Anshan_r=coalesce(Anshan_r,0),Liuzhou_r=coalesce(Liuzhou_r,0),Yancheng_r=coalesce(Yancheng_r,0),Yanbian_Korean_Autonomous_Prefecture_r=coalesce(Yanbian_Korean_Autonomous_Prefecture_r,0),Huaian_r=coalesce(Huaian_r,0),Baotou_r=coalesce(Baotou_r,0),Hengyang_r=coalesce(Hengyang_r,0),Zhangzhou_r=coalesce(Zhangzhou_r,0),Yichang_r=coalesce(Yichang_r,0),Zhangjiang_r=coalesce(Zhangjiang_r,0),Taizhou_jiangsu_r=coalesce(Taizhou_jiangsu_r,0),Ganzhou_r=coalesce(Ganzhou_r,0),Xinxiang_r=coalesce(Xinxiang_r,0),Qiqihar_r=coalesce(Qiqihar_r,0),Zibo_r=coalesce(Zibo_r,0),Sanya_r=coalesce(Sanya_r,0),Zhuzhou_r=coalesce(Zhuzhou_r,0),Jining_r=coalesce(Jining_r,0),Shangqiu_r=coalesce(Shangqiu_r,0),Yinchuan_r=coalesce(Yinchuan_r,0),Dali_Bai_Autonomous_Prefecture_r=coalesce(Dali_Bai_Autonomous_Prefecture_r,0),Jinzhou_r=coalesce(Jinzhou_r,0),Zhaoqing_r=coalesce(Zhaoqing_r,0),Daqing_r=coalesce(Daqing_r,0),Yueyang_r=coalesce(Yueyang_r,0),Lianyungang_r=coalesce(Lianyungang_r,0),Xining_r=coalesce(Xining_r,0),Xianyang_r=coalesce(Xianyang_r,0),Dandong_r=coalesce(Dandong_r,0),Tongliao_r=coalesce(Tongliao_r,0),Changde_r=coalesce(Changde_r,0),Zunyi_r=coalesce(Zunyi_r,0),Nanyang_r=coalesce(Nanyang_r,0),Putian_r=coalesce(Putian_r,0),Suqian_r=coalesce(Suqian_r,0),Chifeng_r=coalesce(Chifeng_r,0),Jiujiang_r=coalesce(Jiujiang_r,0),Cangzhou_r=coalesce(Cangzhou_r,0),Nanchong_r=coalesce(Nanchong_r,0),Handan_r=coalesce(Handan_r,0),Yingkou_r=coalesce(Yingkou_r,0),Fuyang_r=coalesce(Fuyang_r,0),Xinyang_r=coalesce(Xinyang_r,0),Weihai_r=coalesce(Weihai_r,0),Hulunbeir_r=coalesce(Hulunbeir_r,0),Deyang_r=coalesce(Deyang_r,0),Xiangtan_r=coalesce(Xiangtan_r,0),Maanshan_r=coalesce(Maanshan_r,0),Anqing_r=coalesce(Anqing_r,0),Luzhou_r=coalesce(Luzhou_r,0),Panjin_r=coalesce(Panjin_r,0),Yibin_r=coalesce(Yibin_r,0),Shangrao_r=coalesce(Shangrao_r,0),Xiangyang_r=coalesce(Xiangyang_r,0),Quzhou_r=coalesce(Quzhou_r,0),Yuncheng_r=coalesce(Yuncheng_r,0),Lu_an_r=coalesce(Lu_an_r,0),Bengbu_r=coalesce(Bengbu_r,0),Jingzhou_r=coalesce(Jingzhou_r,0),Kaifeng_r=coalesce(Kaifeng_r,0),Zhoukou_r=coalesce(Zhoukou_r,0),Leshan_r=coalesce(Leshan_r,0),Tai_an_r=coalesce(Tai_an_r,0),Chuzhou_r=coalesce(Chuzhou_r,0),Xuchang_r=coalesce(Xuchang_r,0),Huludao_r=coalesce(Huludao_r,0),Fushun_r=coalesce(Fushun_r,0),Siping_r=coalesce(Siping_r,0),Zhumadian_r=coalesce(Zhumadian_r,0),Jieyang_r=coalesce(Jieyang_r,0),Qingyuan_r=coalesce(Qingyuan_r,0),Suihua_r=coalesce(Suihua_r,0),Huanggang_r=coalesce(Huanggang_r,0),Zhangjiakou_r=coalesce(Zhangjiakou_r,0),Huaihua_r=coalesce(Huaihua_r,0),Xiaogan_r=coalesce(Xiaogan_r,0),Maoming_r=coalesce(Maoming_r,0),Anyang_r=coalesce(Anyang_r,0),Tieling_r=coalesce(Tieling_r,0),Datong_r=coalesce(Datong_r,0),Liaoyang_r=coalesce(Liaoyang_r,0),Beihai_r=coalesce(Beihai_r,0),Lishui_r=coalesce(Lishui_r,0),Jiaozuo_r=coalesce(Jiaozuo_r,0),Heze_r=coalesce(Heze_r,0),Chenzhou_r=coalesce(Chenzhou_r,0),Honghe_Hani_and_Yi_Autonomous_Prefecture_r=coalesce(Honghe_Hani_and_Yi_Autonomous_Prefecture_r,0),Longyan_r=coalesce(Longyan_r,0),Songyuan_r=coalesce(Songyuan_r,0),Xingtai_r=coalesce(Xingtai_r,0),Ningde_r=coalesce(Ningde_r,0),Chaozhou_r=coalesce(Chaozhou_r,0),Qujing_r=coalesce(Qujing_r,0),Chengde_r=coalesce(Chengde_r,0),Liaocheng_r=coalesce(Liaocheng_r,0),Pingdingshan_r=coalesce(Pingdingshan_r,0),Nanping_r=coalesce(Nanping_r,0),Yangjiang_r=coalesce(Yangjiang_r,0),Suining_r=coalesce(Suining_r,0),Shaoyang_r=coalesce(Shaoyang_r,0),Shaoguan_r=coalesce(Shaoguan_r,0),Meizhou_r=coalesce(Meizhou_r,0),Jinzhong_r=coalesce(Jinzhong_r,0),Rizhao_r=coalesce(Rizhao_r,0),Lhasa_r=coalesce(Lhasa_r,0),Yichun_jiangxi_r=coalesce(Yichun_jiangxi_r,0),Dezhou_r=coalesce(Dezhou_r,0),Dongying_r=coalesce(Dongying_r,0),Yongzhou_r=coalesce(Yongzhou_r,0),Chaoyang_r=coalesce(Chaoyang_r,0),Tonghua_r=coalesce(Tonghua_r,0),Meishan_r=coalesce(Meishan_r,0),Minnan_Buyi_and_Miao_Autonomous_Prefecture_r=coalesce(Minnan_Buyi_and_Miao_Autonomous_Prefecture_r,0),Yulin_shanxi_r=coalesce(Yulin_shanxi_r,0),Mudanjiang_r=coalesce(Mudanjiang_r,0),Haozhou_r=coalesce(Haozhou_r,0),Luohe_r=coalesce(Luohe_r,0),Jiamusi_r=coalesce(Jiamusi_r,0),Yiyang_r=coalesce(Yiyang_r,0),Yuxi_r=coalesce(Yuxi_r,0),Linfen_r=coalesce(Linfen_r,0),Weinan_r=coalesce(Weinan_r,0),Ji_an_r=coalesce(Ji_an_r,0),Baicheng_r=coalesce(Baicheng_r,0),Xuancheng_r=coalesce(Xuancheng_r,0),Benxi_r=coalesce(Benxi_r,0),Baoji_r=coalesce(Baoji_r,0),Liangshan_Yi_Autonomous_Prefecture_r=coalesce(Liangshan_Yi_Autonomous_Prefecture_r,0),Shanwei_r=coalesce(Shanwei_r,0),Sanming_r=coalesce(Sanming_r,0),Neijiang_r=coalesce(Neijiang_r,0),Jingmen_r=coalesce(Jingmen_r,0),Suzhou_anhui_r=coalesce(Suzhou_anhui_r,0),Tongren_r=coalesce(Tongren_r,0),Bayin_Guoyu_Mongolian_Autonomous_Prefecture_r=coalesce(Bayin_Guoyu_Mongolian_Autonomous_Prefecture_r,0),Fuzhou_jiangxi_r=coalesce(Fuzhou_jiangxi_r,0),Xiangxi_Tujia_and_Miao_Autonomous_Prefecture_r=coalesce(Xiangxi_Tujia_and_Miao_Autonomous_Prefecture_r,0),Dazhou_r=coalesce(Dazhou_r,0),Xing_an_League_r=coalesce(Xing_an_League_r,0),Loudi_r=coalesce(Loudi_r,0),Zaozhuang_r=coalesce(Zaozhuang_r,0),Anshun_r=coalesce(Anshun_r,0),Huangshan_r=coalesce(Huangshan_r,0),Ordos_r=coalesce(Ordos_r,0),Hanzhong_r=coalesce(Hanzhong_r,0),Huangshi_r=coalesce(Huangshi_r,0),Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture_r=coalesce(Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture_r,0),Fuxin_r=coalesce(Fuxin_r,0),Yulin_guangxi_r=coalesce(Yulin_guangxi_r,0),Baishan_r=coalesce(Baishan_r,0),Xianning_r=coalesce(Xianning_r,0),Puyang_r=coalesce(Puyang_r,0),Binzhou_r=coalesce(Binzhou_r,0),Lijiang_r=coalesce(Lijiang_r,0),Bijie_r=coalesce(Bijie_r,0),Changji_Hui_Autonomous_Prefecture_r=coalesce(Changji_Hui_Autonomous_Prefecture_r,0),Zigong_r=coalesce(Zigong_r,0),Wuzhou_r=coalesce(Wuzhou_r,0),Chizhou_r=coalesce(Chizhou_r,0),Tongling_r=coalesce(Tongling_r,0),Wenshan_Zhuang_and_Miao_Autonomous_Prefecture_r=coalesce(Wenshan_Zhuang_and_Miao_Autonomous_Prefecture_r,0),Hengshui_r=coalesce(Hengshui_r,0),Pu_er_r=coalesce(Pu_er_r,0),Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture_r=coalesce(Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture_r,0),Huaibei_r=coalesce(Huaibei_r,0),Baise_r=coalesce(Baise_r,0),Heyuan_r=coalesce(Heyuan_r,0),Enshi_Tujia_and_Miao_Autonomous_Prefecture_r=coalesce(Enshi_Tujia_and_Miao_Autonomous_Prefecture_r,0),Huainan_r=coalesce(Huainan_r,0),Bayannaoer_r=coalesce(Bayannaoer_r,0),Shiyan_r=coalesce(Shiyan_r,0),Xilin_Gol_League_r=coalesce(Xilin_Gol_League_r,0),Ziyang_r=coalesce(Ziyang_r,0),Bazhong_r=coalesce(Bazhong_r,0),Zhoushan_r=coalesce(Zhoushan_r,0),Jingdezhen_r=coalesce(Jingdezhen_r,0),Qinzhou_r=coalesce(Qinzhou_r,0),Sanmenxia_r=coalesce(Sanmenxia_r,0),Changzhi_r=coalesce(Changzhi_r,0),Wulanchabu_r=coalesce(Wulanchabu_r,0),Linzhi_r=coalesce(Linzhi_r,0),Zhaotong_r=coalesce(Zhaotong_r,0),Liupanshui_r=coalesce(Liupanshui_r,0),Shihezi_r=coalesce(Shihezi_r,0),Zhangjiajie_r=coalesce(Zhangjiajie_r,0),Guangyuan_r=coalesce(Guangyuan_r,0),Chuxiong_Yi_Autonomous_Prefecture_r=coalesce(Chuxiong_Yi_Autonomous_Prefecture_r,0),Ankang_r=coalesce(Ankang_r,0),Ili_Kazakh_Autonomous_Prefecture_r=coalesce(Ili_Kazakh_Autonomous_Prefecture_r,0),Jixi_r=coalesce(Jixi_r,0),Yunfu_r=coalesce(Yunfu_r,0),Jiuquan_r=coalesce(Jiuquan_r,0),Wuzhong_r=coalesce(Wuzhong_r,0),Dehong_Dai_Jingpo_Autonomous_Prefecture_r=coalesce(Dehong_Dai_Jingpo_Autonomous_Prefecture_r,0),Baoshan_r=coalesce(Baoshan_r,0),Luliang_r=coalesce(Luliang_r,0),Aksu_area_r=coalesce(Aksu_area_r,0),Hechi_r=coalesce(Hechi_r,0),Guigang_r=coalesce(Guigang_r,0),Guang_an_r=coalesce(Guang_an_r,0),Xinzhou_r=coalesce(Xinzhou_r,0),Xishuangbanna_Dai_Autonomous_Prefecture_r=coalesce(Xishuangbanna_Dai_Autonomous_Prefecture_r,0),Heihe_r=coalesce(Heihe_r,0),Yan_an_r=coalesce(Yan_an_r,0),Xinyu_r=coalesce(Xinyu_r,0),Chongzuo_r=coalesce(Chongzuo_r,0),Panzhihua_r=coalesce(Panzhihua_r,0),Ezhou_r=coalesce(Ezhou_r,0),Fangchenggang_r=coalesce(Fangchenggang_r,0),Hebi_r=coalesce(Hebi_r,0),Yangquan_r=coalesce(Yangquan_r,0),Ya_an_r=coalesce(Ya_an_r,0),Wuhai_r=coalesce(Wuhai_r,0),Jincheng_r=coalesce(Jincheng_r,0),Liaoyuan_r=coalesce(Liaoyuan_r,0),Shuangyashan_r=coalesce(Shuangyashan_r,0),Danzhou_r=coalesce(Danzhou_r,0),Yingtan_r=coalesce(Yingtan_r,0),Pingxiang_r=coalesce(Pingxiang_r,0),Hami_r=coalesce(Hami_r,0),Karamay_r=coalesce(Karamay_r,0),Lincang_r=coalesce(Lincang_r,0),Suizhou_r=coalesce(Suizhou_r,0),Shuozhou_r=coalesce(Shuozhou_r,0),Tacheng_area_r=coalesce(Tacheng_area_r,0),Dingxi_r=coalesce(Dingxi_r,0),Kashgar_r=coalesce(Kashgar_r,0),Qionghai_r=coalesce(Qionghai_r,0),Yichun_heilongjiang_r=coalesce(Yichun_heilongjiang_r,0),Laibin_r=coalesce(Laibin_r,0),Tianshui_r=coalesce(Tianshui_r,0),Laiwu_r=coalesce(Laiwu_r,0),Hezhou_r=coalesce(Hezhou_r,0),Qingyang_r=coalesce(Qingyang_r,0),Qitaihe_r=coalesce(Qitaihe_r,0),Shizuishan_r=coalesce(Shizuishan_r,0),Jiayuguan_r=coalesce(Jiayuguan_r,0),Xiantao_r=coalesce(Xiantao_r,0),Bortala_Mongolian_Autonomous_Prefecture_r=coalesce(Bortala_Mongolian_Autonomous_Prefecture_r,0),Wuwei_r=coalesce(Wuwei_r,0),Haixi_Mongolian_Tibetan_Autonomous_Prefecture_r=coalesce(Haixi_Mongolian_Tibetan_Autonomous_Prefecture_r,0),Pingliang_r=coalesce(Pingliang_r,0),Tulufan_r=coalesce(Tulufan_r,0),Baiyin_r=coalesce(Baiyin_r,0),Zhongwei_r=coalesce(Zhongwei_r,0),Tianmen_r=coalesce(Tianmen_r,0),Shangluo_r=coalesce(Shangluo_r,0),Haidong_r=coalesce(Haidong_r,0),Jiyuan_r=coalesce(Jiyuan_r,0),Qianjiang_r=coalesce(Qianjiang_r,0),Linxia_Hui_Autonomous_Prefecture_r=coalesce(Linxia_Hui_Autonomous_Prefecture_r,0),Longnan_r=coalesce(Longnan_r,0),Aba_Tibetan_and_Qiang_Autonomous_Prefecture_r=coalesce(Aba_Tibetan_and_Qiang_Autonomous_Prefecture_r,0),Jinchang_r=coalesce(Jinchang_r,0),Zhangye_r=coalesce(Zhangye_r,0),Guyuan_r=coalesce(Guyuan_r,0),Alxa_League_r=coalesce(Alxa_League_r,0),Rikaze_r=coalesce(Rikaze_r,0),Hegang_r=coalesce(Hegang_r,0),Dongfang_r=coalesce(Dongfang_r,0),Wenchang_r=coalesce(Wenchang_r,0),Hotan_area_r=coalesce(Hotan_area_r,0),Wanning_r=coalesce(Wanning_r,0),Diqing_Tibetan_Autonomous_Prefecture_r=coalesce(Diqing_Tibetan_Autonomous_Prefecture_r,0),Ganzi_Tibetan_Autonomous_Prefecture_r=coalesce(Ganzi_Tibetan_Autonomous_Prefecture_r,0),Linshui_Lizu_Autonomous_Prefecture_r=coalesce(Linshui_Lizu_Autonomous_Prefecture_r,0),Shannan_r=coalesce(Shannan_r,0),Hainan_Tibetan_Autonomous_Prefecture_r=coalesce(Hainan_Tibetan_Autonomous_Prefecture_r,0),Tongchuan_r=coalesce(Tongchuan_r,0),Altay_area_r=coalesce(Altay_area_r,0),Changjiang_Lizu_Autonomus_Prefecture_r=coalesce(Changjiang_Lizu_Autonomus_Prefecture_r,0),Chengmai_r=coalesce(Chengmai_r,0),Changdu_r=coalesce(Changdu_r,0),Alaer_r=coalesce(Alaer_r,0),Nagqu_area_r=coalesce(Nagqu_area_r,0),Wujiaqu_r=coalesce(Wujiaqu_r,0),Nujiang_Yi_Autonomous_Prefecture_r=coalesce(Nujiang_Yi_Autonomous_Prefecture_r,0),Beitun_r=coalesce(Beitun_r,0),Kizilsu_Kirghiz_Autonomous_Prefecture_r=coalesce(Kizilsu_Kirghiz_Autonomous_Prefecture_r,0),Ledong_Lizu_Autonomous_Prefecture_r=coalesce(Ledong_Lizu_Autonomous_Prefecture_r,0),Ali_area_r=coalesce(Ali_area_r,0),Lingao_r=coalesce(Lingao_r,0),Daxinganling_area_r=coalesce(Daxinganling_area_r,0),Wuzhishan_r=coalesce(Wuzhishan_r,0),Gannan_Tibetan_Autonomous_Prefecture_r=coalesce(Gannan_Tibetan_Autonomous_Prefecture_r,0),Qiongzhong_Lizu_Miaozu_Autonomous_Prefecture_r=coalesce(Qiongzhong_Lizu_Miaozu_Autonomous_Prefecture_r,0),Baoting_Lizu_Miaozu_Autonomous_Prefecture_r=coalesce(Baoting_Lizu_Miaozu_Autonomous_Prefecture_r,0),Tunchang_r=coalesce(Tunchang_r,0),Huangnan_Tibetan_Autonomous_Prefecture_r=coalesce(Huangnan_Tibetan_Autonomous_Prefecture_r,0),Anding_r=coalesce(Anding_r,0),Yushu_Tibetan_Autonomous_Prefecture_r=coalesce(Yushu_Tibetan_Autonomous_Prefecture_r,0),Basha_Lizu_Autonomous_Prefecture_r=coalesce(Basha_Lizu_Autonomous_Prefecture_r,0),Haibei_Tibetan_Autonomous_Prefecture_r=coalesce(Haibei_Tibetan_Autonomous_Prefecture_r,0),Shennongjia_Forrest_r=coalesce(Shennongjia_Forrest_r,0),shuanghe_r=coalesce(shuanghe_r,0),xinjiang_autonomous_districts_r=coalesce(xinjiang_autonomous_districts_r,0),Hebei=coalesce(Hebei,0),Shanxi=coalesce(Shanxi,0),Liaoning=coalesce(Liaoning,0),Jilin_1=coalesce(Jilin_1,0),Heilongjiang=coalesce(Heilongjiang,0),Jiangsu=coalesce(Jiangsu,0),Zhejiang=coalesce(Zhejiang,0),Anhui=coalesce(Anhui,0),Fujian=coalesce(Fujian,0),Jiangxi=coalesce(Jiangxi,0),Shandong=coalesce(Shandong,0),Henan=coalesce(Henan,0),Hubei=coalesce(Hubei,0),Hunan=coalesce(Hunan,0),Guangdong=coalesce(Guangdong,0),Hainan=coalesce(Hainan,0),Sichuan=coalesce(Sichuan,0),Guizhou=coalesce(Guizhou,0),Yunnan=coalesce(Yunnan,0),Shaanxi=coalesce(Shaanxi,0),Gansu=coalesce(Gansu,0),Qinghai=coalesce(Qinghai,0),Neimenggu=coalesce(Neimenggu,0),Guangxi=coalesce(Guangxi,0),Xizang=coalesce(Xizang,0),Ningxia=coalesce(Ningxia,0),Xinjiang=coalesce(Xinjiang,0),total_store=coalesce(total_store,0),total_store_r=coalesce(total_store_r,0),Hebei_r=coalesce(Hebei_r,0),Shanxi_r=coalesce(Shanxi_r,0),Liaoning_r=coalesce(Liaoning_r,0),Jilin_1_r=coalesce(Jilin_1_r,0),Heilongjiang_r=coalesce(Heilongjiang_r,0),Jiangsu_r=coalesce(Jiangsu_r,0),Zhejiang_r=coalesce(Zhejiang_r,0),Anhui_r=coalesce(Anhui_r,0),Fujian_r=coalesce(Fujian_r,0),Jiangxi_r=coalesce(Jiangxi_r,0),Shandong_r=coalesce(Shandong_r,0),Henan_r=coalesce(Henan_r,0),Hubei_r=coalesce(Hubei_r,0),Hunan_r=coalesce(Hunan_r,0),Guangdong_r=coalesce(Guangdong_r,0),Hainan_r=coalesce(Hainan_r,0),Sichuan_r=coalesce(Sichuan_r,0),Guizhou_r=coalesce(Guizhou_r,0),Yunnan_r=coalesce(Yunnan_r,0),Shaanxi_r=coalesce(Shaanxi_r,0),Gansu_r=coalesce(Gansu_r,0),Qinghai_r=coalesce(Qinghai_r,0),Neimenggu_r=coalesce(Neimenggu_r,0),Guangxi_r=coalesce(Guangxi_r,0),Xizang_r=coalesce(Xizang_r,0),Ningxia_r=coalesce(Ningxia_r,0),Xinjiang_r=coalesce(Xinjiang_r,0)
where ts='2020-03'；





--更新一二三级城市数据
update common_ticker.luckin_data_monthly set 
fifth_tier=Suihua+Songyuan+Lhasa+Yongzhou+Chaoyang+Haozhou+Luohe+Yiyang+Baicheng+Liangshan_Yi_Autonomous_Prefecture+Jingmen+Tongren+Bayin_Guoyu_Mongolian_Autonomous_Prefecture+Xiangxi_Tujia_and_Miao_Autonomous_Prefecture+Dazhou+Xing_an_League+Anshun+Hanzhong+Baishan+Puyang+Bijie+Changji_Hui_Autonomous_Prefecture+Zigong+Chizhou+Tongling+Wenshan_Zhuang_and_Miao_Autonomous_Prefecture+Hengshui+Pu_er+Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture+Huaibei+Baise+Bayannaoer+Xilin_Gol_League+Ziyang+Bazhong+Qinzhou+Sanmenxia+Changzhi+Wulanchabu+Linzhi+Zhaotong+Liupanshui+Shihezi+Zhangjiajie+Guangyuan+Chuxiong_Yi_Autonomous_Prefecture+Ankang+Ili_Kazakh_Autonomous_Prefecture+Jixi+Yunfu+Jiuquan+Wuzhong+Dehong_Dai_Jingpo_Autonomous_Prefecture+Baoshan+Luliang+Aksu_area+Hechi+Guigang+Guang_an+Xinzhou+Heihe+Yan_an+Xinyu+Chongzuo+Panzhihua+Ezhou+Fangchenggang+Hebi+Yangquan+Wuhai+Jincheng+Liaoyuan+Shuangyashan+Danzhou+Yingtan+Pingxiang+Hami+Karamay+Lincang+Suizhou+Shuozhou+Tacheng_area+Dingxi+Kashgar+Qionghai+Yichun_heilongjiang+Laibin+Tianshui+Laiwu+Hezhou+Qingyang+Qitaihe+Shizuishan+Jiayuguan+Xiantao+Bortala_Mongolian_Autonomous_Prefecture+Wuwei+Haixi_Mongolian_Tibetan_Autonomous_Prefecture+Pingliang+Tulufan+Baiyin+Zhongwei+Tianmen+Shangluo+Haidong+Jiyuan+Qianjiang+Linxia_Hui_Autonomous_Prefecture+Longnan+Aba_Tibetan_and_Qiang_Autonomous_Prefecture+Jinchang+Zhangye+Guyuan+Alxa_League+Rikaze+Hegang+Dongfang+Wenchang+Hotan_area+Wanning+Diqing_Tibetan_Autonomous_Prefecture+Ganzi_Tibetan_Autonomous_Prefecture+Linshui_Lizu_Autonomous_Prefecture+Shannan+Hainan_Tibetan_Autonomous_Prefecture+Tongchuan+Altay_area+Changjiang_Lizu_Autonomus_Prefecture+Chengmai+Changdu+Alaer+Nagqu_area+Wujiaqu+Nujiang_Yi_Autonomous_Prefecture+Beitun+Kizilsu_Kirghiz_Autonomous_Prefecture+Ledong_Lizu_Autonomous_Prefecture+Ali_area+Lingao+Daxinganling_area+Wuzhishan+Gannan_Tibetan_Autonomous_Prefecture+Qiongzhong_Lizu_Miaozu_Autonomous_Prefecture+Baoting_Lizu_Miaozu_Autonomous_Prefecture+Tunchang+Huangnan_Tibetan_Autonomous_Prefecture+Anding+Yushu_Tibetan_Autonomous_Prefecture+Basha_Lizu_Autonomous_Prefecture+Haibei_Tibetan_Autonomous_Prefecture+Shennongjia_Forrest+shuanghe+xinjiang_autonomous_districts,
fifth_tier_r=Suihua_r+Songyuan_r+Lhasa_r+Yongzhou_r+Chaoyang_r+Haozhou_r+Luohe_r+Yiyang_r+Baicheng_r+Liangshan_Yi_Autonomous_Prefecture_r+Jingmen_r+Tongren_r+Bayin_Guoyu_Mongolian_Autonomous_Prefecture_r+Xiangxi_Tujia_and_Miao_Autonomous_Prefecture_r+Dazhou_r+Xing_an_League_r+Anshun_r+Hanzhong_r+Baishan_r+Puyang_r+Bijie_r+Changji_Hui_Autonomous_Prefecture_r+Zigong_r+Chizhou_r+Tongling_r+Wenshan_Zhuang_and_Miao_Autonomous_Prefecture_r+Hengshui_r+Pu_er_r+Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture_r+Huaibei_r+Baise_r+Bayannaoer_r+Xilin_Gol_League_r+Ziyang_r+Bazhong_r+Qinzhou_r+Sanmenxia_r+Changzhi_r+Wulanchabu_r+Linzhi_r+Zhaotong_r+Liupanshui_r+Shihezi_r+Zhangjiajie_r+Guangyuan_r+Chuxiong_Yi_Autonomous_Prefecture_r+Ankang_r+Ili_Kazakh_Autonomous_Prefecture_r+Jixi_r+Yunfu_r+Jiuquan_r+Wuzhong_r+Dehong_Dai_Jingpo_Autonomous_Prefecture_r+Baoshan_r+Luliang_r+Aksu_area_r+Hechi_r+Guigang_r+Guang_an_r+Xinzhou_r+Heihe_r+Yan_an_r+Xinyu_r+Chongzuo_r+Panzhihua_r+Ezhou_r+Fangchenggang_r+Hebi_r+Yangquan_r+Wuhai_r+Jincheng_r+Liaoyuan_r+Shuangyashan_r+Danzhou_r+Yingtan_r+Pingxiang_r+Hami_r+Karamay_r+Lincang_r+Suizhou_r+Shuozhou_r+Tacheng_area_r+Dingxi_r+Kashgar_r+Qionghai_r+Yichun_heilongjiang_r+Laibin_r+Tianshui_r+Laiwu_r+Hezhou_r+Qingyang_r+Qitaihe_r+Shizuishan_r+Jiayuguan_r+Xiantao_r+Bortala_Mongolian_Autonomous_Prefecture_r+Wuwei_r+Haixi_Mongolian_Tibetan_Autonomous_Prefecture_r+Pingliang_r+Tulufan_r+Baiyin_r+Zhongwei_r+Tianmen_r+Shangluo_r+Haidong_r+Jiyuan_r+Qianjiang_r+Linxia_Hui_Autonomous_Prefecture_r+Longnan_r+Aba_Tibetan_and_Qiang_Autonomous_Prefecture_r+Jinchang_r+Zhangye_r+Guyuan_r+Alxa_League_r+Rikaze_r+Hegang_r+Dongfang_r+Wenchang_r+Hotan_area_r+Wanning_r+Diqing_Tibetan_Autonomous_Prefecture_r+Ganzi_Tibetan_Autonomous_Prefecture_r+Linshui_Lizu_Autonomous_Prefecture_r+Shannan_r+Hainan_Tibetan_Autonomous_Prefecture_r+Tongchuan_r+Altay_area_r+Changjiang_Lizu_Autonomus_Prefecture_r+Chengmai_r+Changdu_r+Alaer_r+Nagqu_area_r+Wujiaqu_r+Nujiang_Yi_Autonomous_Prefecture_r+Beitun_r+Kizilsu_Kirghiz_Autonomous_Prefecture_r+Ledong_Lizu_Autonomous_Prefecture_r+Ali_area_r+Lingao_r+Daxinganling_area_r+Wuzhishan_r+Gannan_Tibetan_Autonomous_Prefecture_r+Qiongzhong_Lizu_Miaozu_Autonomous_Prefecture_r+Baoting_Lizu_Miaozu_Autonomous_Prefecture_r+Tunchang_r+Huangnan_Tibetan_Autonomous_Prefecture_r+Anding_r+Yushu_Tibetan_Autonomous_Prefecture_r+Basha_Lizu_Autonomous_Prefecture_r+Haibei_Tibetan_Autonomous_Prefecture_r+Shennongjia_Forrest_r+shuanghe_r+xinjiang_autonomous_districts_r,
first_tier=Beijing+Shanghai+Guangzhou+Shenzhen,
first_tier_r=Beijing_r+Shanghai_r+Guangzhou_r+Shenzhen_r,
fourth_tier=Xinxiang+Shangqiu+Dali_Bai_Autonomous_Prefecture+Jinzhou+Tongliao+Changde+Zunyi+Suqian+Chifeng+Fuyang+Xinyang+Hulunbeir+Deyang+Xiangtan+Anqing+Luzhou+Yibin+Yuncheng+Lu_an+Kaifeng+Zhoukou+Leshan+Chuzhou+Xuchang+Huludao+Siping+Zhumadian+Huanggang+Zhangjiakou+Huaihua+Maoming+Anyang+Tieling+Datong+Liaoyang+Beihai+Jiaozuo+Heze+Chenzhou+Honghe_Hani_and_Yi_Autonomous_Prefecture+Xingtai+Chaozhou+Qujing+Chengde+Liaocheng+Pingdingshan+Yangjiang+Suining+Shaoyang+Shaoguan+Meizhou+Jinzhong+Rizhao+Yichun_jiangxi+Dezhou+Tonghua+Meishan+Minnan_Buyi_and_Miao_Autonomous_Prefecture+Yulin_shanxi+Mudanjiang+Jiamusi+Yuxi+Linfen+Weinan+Ji_an+Xuancheng+Benxi+Baoji+Shanwei+Neijiang+Suzhou_anhui+Fuzhou_jiangxi+Loudi+Zaozhuang+Huangshan+Ordos+Huangshi+Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture+Fuxin+Yulin_guangxi+Xianning+Binzhou+Wuzhou+Heyuan+Enshi_Tujia_and_Miao_Autonomous_Prefecture+Huainan+Shiyan+Jingdezhen+Xishuangbanna_Dai_Autonomous_Prefecture+Ya_an,
fourth_tier_r=Xinxiang_r+Shangqiu_r+Dali_Bai_Autonomous_Prefecture_r+Jinzhou_r+Tongliao_r+Changde_r+Zunyi_r+Suqian_r+Chifeng_r+Fuyang_r+Xinyang_r+Hulunbeir_r+Deyang_r+Xiangtan_r+Anqing_r+Luzhou_r+Yibin_r+Yuncheng_r+Lu_an_r+Kaifeng_r+Zhoukou_r+Leshan_r+Chuzhou_r+Xuchang_r+Huludao_r+Siping_r+Zhumadian_r+Huanggang_r+Zhangjiakou_r+Huaihua_r+Maoming_r+Anyang_r+Tieling_r+Datong_r+Liaoyang_r+Beihai_r+Jiaozuo_r+Heze_r+Chenzhou_r+Honghe_Hani_and_Yi_Autonomous_Prefecture_r+Xingtai_r+Chaozhou_r+Qujing_r+Chengde_r+Liaocheng_r+Pingdingshan_r+Yangjiang_r+Suining_r+Shaoyang_r+Shaoguan_r+Meizhou_r+Jinzhong_r+Rizhao_r+Yichun_jiangxi_r+Dezhou_r+Tonghua_r+Meishan_r+Minnan_Buyi_and_Miao_Autonomous_Prefecture_r+Yulin_shanxi_r+Mudanjiang_r+Jiamusi_r+Yuxi_r+Linfen_r+Weinan_r+Ji_an_r+Xuancheng_r+Benxi_r+Baoji_r+Shanwei_r+Neijiang_r+Suzhou_anhui_r+Fuzhou_jiangxi_r+Loudi_r+Zaozhuang_r+Huangshan_r+Ordos_r+Huangshi_r+Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture_r+Fuxin_r+Yulin_guangxi_r+Xianning_r+Binzhou_r+Wuzhou_r+Heyuan_r+Enshi_Tujia_and_Miao_Autonomous_Prefecture_r+Huainan_r+Shiyan_r+Jingdezhen_r+Xishuangbanna_Dai_Autonomous_Prefecture_r+Ya_an_r,
new_first_tier=Chengdu+Chongqing+Hangzhou+Suzhou_jiangsu+Wuhan+Nanjing+Tianjin+Zhengzhou+Changsha+Shenyang+Dongguan+Xi_an+Ningbo+Qingdao+Dalian,
new_first_tier_r=Chengdu_r+Chongqing_r+Hangzhou_r+Suzhou_jiangsu_r+Wuhan_r+Nanjing_r+Tianjin_r+Zhengzhou_r+Changsha_r+Shenyang_r+Dongguan_r+Xi_an_r+Ningbo_r+Qingdao_r+Dalian_r,
second_tier=Hefei+Changchun+Kunming+Wuxi+Harbin+Foshan+Fuzhou_fujian+Jinan+Nanchang+Jinhua+Nanning+Huizhou+Zhongshan+Shijiazhuang+Taizhou_zhejiang+Guiyang+Xiamen+Haikou+Quanzhou+Changzhou+Xuzhou+Taiyuan+Nantong+Zhuhai+Jiaxing+Wenzhou+Shaoxing+Urumqi+Lanzhou+Yantai,
second_tier_r=Hefei_r+Changchun_r+Kunming_r+Wuxi_r+Harbin_r+Foshan_r+Fuzhou_fujian_r+Jinan_r+Nanchang_r+Jinhua_r+Nanning_r+Huizhou_r+Zhongshan_r+Shijiazhuang_r+Taizhou_zhejiang_r+Guiyang_r+Xiamen_r+Haikou_r+Quanzhou_r+Changzhou_r+Xuzhou_r+Taiyuan_r+Nantong_r+Zhuhai_r+Jiaxing_r+Wenzhou_r+Shaoxing_r+Urumqi_r+Lanzhou_r+Yantai_r,
third_tier=Hohhot+Tangshan+Jilin_1+Langfang+Baoding+Shantou+Wuhu+Linyi+Luoyang+Guilin+Yangzhou+Jiangmen+Huzhou+Qinhuangdao+Mianyang+Weifang+Zhenjiang+Anshan+Liuzhou+Yancheng+Yanbian_Korean_Autonomous_Prefecture+Huaian+Baotou+Hengyang+Zhangzhou+Yichang+Zhangjiang+Taizhou_jiangsu+Ganzhou+Qiqihar+Zibo+Sanya+Zhuzhou+Jining+Yinchuan+Zhaoqing+Daqing+Yueyang+Lianyungang+Xining+Xianyang+Dandong+Nanyang+Putian+Jiujiang+Cangzhou+Nanchong+Handan+Yingkou+Weihai+Maanshan+Panjin+Shangrao+Xiangyang+Quzhou+Bengbu+Jingzhou+Tai_an+Fushun+Jieyang+Qingyuan+Xiaogan+Lishui+Longyan+Ningde+Nanping+Dongying+Sanming+Lijiang+Zhoushan,
third_tier_r=Hohhot_r+Tangshan_r+Jilin_1_r+Langfang_r+Baoding_r+Shantou_r+Wuhu_r+Linyi_r+Luoyang_r+Guilin_r+Yangzhou_r+Jiangmen_r+Huzhou_r+Qinhuangdao_r+Mianyang_r+Weifang_r+Zhenjiang_r+Anshan_r+Liuzhou_r+Yancheng_r+Yanbian_Korean_Autonomous_Prefecture_r+Huaian_r+Baotou_r+Hengyang_r+Zhangzhou_r+Yichang_r+Zhangjiang_r+Taizhou_jiangsu_r+Ganzhou_r+Qiqihar_r+Zibo_r+Sanya_r+Zhuzhou_r+Jining_r+Yinchuan_r+Zhaoqing_r+Daqing_r+Yueyang_r+Lianyungang_r+Xining_r+Xianyang_r+Dandong_r+Nanyang_r+Putian_r+Jiujiang_r+Cangzhou_r+Nanchong_r+Handan_r+Yingkou_r+Weihai_r+Maanshan_r+Panjin_r+Shangrao_r+Xiangyang_r+Quzhou_r+Bengbu_r+Jingzhou_r+Tai_an_r+Fushun_r+Jieyang_r+Qingyuan_r+Xiaogan_r+Lishui_r+Longyan_r+Ningde_r+Nanping_r+Dongying_r+Sanming_r+Lijiang_r+Zhoushan_r,
total_store_cnt=first_tier+new_first_tier+second_tier+third_tier+fourth_tier+fifth_tier,
total_store_cnt_r=first_tier_r+new_first_tier_r+second_tier_r+third_tier_r+fourth_tier_r+fifth_tier_r
where ts='2020-03';



--更新展示项目
update common_ticker.table_info set display=1
where table_name='luckin_data_monthly' and field_name in
    (
'total_store_cnt','total_store_cnt_r','first_tier','new_first_tier','second_tier','third_tier','fourth_tier','fifth_tier','first_tier_r','new_first_tier_r','second_tier_r','third_tier_r','fourth_tier_r','fifth_tier_r','Beijing','Shanghai','Guangzhou','Shenzhen','Chengdu','Chongqing','Hangzhou','Suzhou_jiangsu','Wuhan','Nanjing','Tianjin','Zhengzhou','Changsha','Shenyang','Dongguan','Hefei','Changchun','Kunming','Xi_an','Wuxi','Harbin','Foshan','Fuzhou_fujian','Ningbo','Jinan','Nanchang','Qingdao','Jinhua','Nanning','Dalian','Hohhot','Huizhou','Zhongshan','Shijiazhuang','Taizhou_zhejiang','Guiyang','Xiamen','Haikou','Quanzhou','Changzhou','Xuzhou','Taiyuan','Nantong','Zhuhai','Tangshan','Jilin','Jiaxing','Wenzhou','Langfang','Shaoxing','Baoding','Urumqi','Shantou','Wuhu','Linyi','Luoyang','Guilin','Lanzhou','Yangzhou','Jiangmen','Huzhou','Qinhuangdao','Mianyang','Weifang','Yantai','Zhenjiang','Anshan','Liuzhou','Yancheng','Yanbian_Korean_Autonomous_Prefecture','Huaian','Baotou','Hengyang','Zhangzhou','Yichang','Zhangjiang','Taizhou_jiangsu','Ganzhou','Xinxiang','Qiqihar','Zibo','Sanya','Zhuzhou','Jining','Shangqiu','Yinchuan','Dali_Bai_Autonomous_Prefecture','Jinzhou','Zhaoqing','Daqing','Yueyang','Lianyungang','Xining','Xianyang','Dandong','Tongliao','Changde','Zunyi','Nanyang','Putian','Suqian','Chifeng','Jiujiang','Cangzhou','Nanchong','Handan','Yingkou','Fuyang','Xinyang','Weihai','Hulunbeir','Deyang','Xiangtan','Maanshan','Anqing','Luzhou','Panjin','Yibin','Shangrao','Xiangyang','Quzhou','Yuncheng','Lu_an','Bengbu','Jingzhou','Kaifeng','Zhoukou','Leshan','Tai_an','Chuzhou','Xuchang','Huludao','Fushun','Siping','Zhumadian','Jieyang','Qingyuan','Suihua','Huanggang','Zhangjiakou','Huaihua','Xiaogan','Maoming','Anyang','Tieling','Datong','Liaoyang','Beihai','Lishui','Jiaozuo','Heze','Chenzhou','Honghe_Hani_and_Yi_Autonomous_Prefecture','Longyan','Songyuan','Xingtai','Ningde','Chaozhou','Qujing','Chengde','Liaocheng','Pingdingshan','Nanping','Yangjiang','Suining','Shaoyang','Shaoguan','Meizhou','Jinzhong','Rizhao','Lhasa','Yichun_jiangxi','Dezhou','Dongying','Yongzhou','Chaoyang','Tonghua','Meishan','Minnan_Buyi_and_Miao_Autonomous_Prefecture','Yulin_shanxi','Mudanjiang','Haozhou','Luohe','Jiamusi','Yiyang','Yuxi','Linfen','Weinan','Ji_an','Baicheng','Xuancheng','Benxi','Baoji','Liangshan_Yi_Autonomous_Prefecture','Shanwei','Sanming','Neijiang','Jingmen','Suzhou_anhui','Tongren','Bayin_Guoyu_Mongolian_Autonomous_Prefecture','Fuzhou_jiangxi','Xiangxi_Tujia_and_Miao_Autonomous_Prefecture','Dazhou','Xing_an_League','Loudi','Zaozhuang','Anshun','Huangshan','Ordos','Hanzhong','Huangshi','Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture','Fuxin','Yulin_guangxi','Baishan','Xianning','Puyang','Binzhou','Lijiang','Bijie','Changji_Hui_Autonomous_Prefecture','Zigong','Wuzhou','Chizhou','Tongling','Wenshan_Zhuang_and_Miao_Autonomous_Prefecture','Hengshui','Pu_er','Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture','Huaibei','Baise','Heyuan','Enshi_Tujia_and_Miao_Autonomous_Prefecture','Huainan','Bayannaoer','Shiyan','Xilin_Gol_League','Ziyang','Bazhong','Zhoushan','Jingdezhen','Qinzhou','Sanmenxia','Changzhi','Wulanchabu','Linzhi','Zhaotong','Liupanshui','Shihezi','Zhangjiajie','Guangyuan','Chuxiong_Yi_Autonomous_Prefecture','Ankang','Ili_Kazakh_Autonomous_Prefecture','Jixi','Yunfu','Jiuquan','Wuzhong','Dehong_Dai_Jingpo_Autonomous_Prefecture','Baoshan','Luliang','Aksu_area','Hechi','Guigang','Guang_an','Xinzhou','Xishuangbanna_Dai_Autonomous_Prefecture','Heihe','Yan_an','Xinyu','Chongzuo','Panzhihua','Ezhou','Fangchenggang','Hebi','Yangquan','Ya_an','Wuhai','Jincheng','Liaoyuan','Shuangyashan','Danzhou','Yingtan','Pingxiang','Hami','Karamay','Lincang','Suizhou','Shuozhou','Tacheng_area','Dingxi','Kashgar','Qionghai','Yichun_heilongjiang','Laibin','Tianshui','Laiwu','Hezhou','Qingyang','Qitaihe','Shizuishan','Jiayuguan','Xiantao','Bortala_Mongolian_Autonomous_Prefecture','Wuwei','Haixi_Mongolian_Tibetan_Autonomous_Prefecture','Pingliang','Tulufan','Baiyin','Zhongwei','Tianmen','Shangluo','Haidong','Jiyuan','Qianjiang','Linxia_Hui_Autonomous_Prefecture','Longnan','Aba_Tibetan_and_Qiang_Autonomous_Prefecture','Jinchang','Zhangye','Guyuan','Alxa_League','Rikaze','Hegang','Dongfang','Wenchang','Hotan_area','Wanning','Diqing_Tibetan_Autonomous_Prefecture','Ganzi_Tibetan_Autonomous_Prefecture','Linshui_Lizu_Autonomous_Prefecture','Shannan','Hainan_Tibetan_Autonomous_Prefecture','Tongchuan','Altay_area','Changjiang_Lizu_Autonomus_Prefecture','Chengmai','Changdu','Alaer','Nagqu_area','Wujiaqu','Nujiang_Yi_Autonomous_Prefecture','Beitun','Kizilsu_Kirghiz_Autonomous_Prefecture','Ledong_Lizu_Autonomous_Prefecture','Ali_area','Lingao','Daxinganling_area','Wuzhishan','Gannan_Tibetan_Autonomous_Prefecture','Qiongzhong_Lizu_Miaozu_Autonomous_Prefecture','Baoting_Lizu_Miaozu_Autonomous_Prefecture','Tunchang','Huangnan_Tibetan_Autonomous_Prefecture','Anding','Yushu_Tibetan_Autonomous_Prefecture','Basha_Lizu_Autonomous_Prefecture','Haibei_Tibetan_Autonomous_Prefecture','Shennongjia_Forrest','shuanghe','xinjiang_autonomous_districts','Beijing_r','Shanghai_r','Guangzhou_r','Shenzhen_r','Chengdu_r','Chongqing_r','Hangzhou_r','Suzhou_jiangsu_r','Wuhan_r','Nanjing_r','Tianjin_r','Zhengzhou_r','Changsha_r','Shenyang_r','Dongguan_r','Hefei_r','Changchun_r','Kunming_r','Xi_an_r','Wuxi_r','Harbin_r','Foshan_r','Fuzhou_fujian_r','Ningbo_r','Jinan_r','Nanchang_r','Qingdao_r','Jinhua_r','Nanning_r','Dalian_r','Hohhot_r','Huizhou_r','Zhongshan_r','Shijiazhuang_r','Taizhou_zhejiang_r','Guiyang_r','Xiamen_r','Haikou_r','Quanzhou_r','Changzhou_r','Xuzhou_r','Taiyuan_r','Nantong_r','Zhuhai_r','Tangshan_r','Jilin_r','Jiaxing_r','Wenzhou_r','Langfang_r','Shaoxing_r','Baoding_r','Urumqi_r','Shantou_r','Wuhu_r','Linyi_r','Luoyang_r','Guilin_r','Lanzhou_r','Yangzhou_r','Jiangmen_r','Huzhou_r','Qinhuangdao_r','Mianyang_r','Weifang_r','Yantai_r','Zhenjiang_r','Anshan_r','Liuzhou_r','Yancheng_r','Yanbian_Korean_Autonomous_Prefecture_r','Huaian_r','Baotou_r','Hengyang_r','Zhangzhou_r','Yichang_r','Zhangjiang_r','Taizhou_jiangsu_r','Ganzhou_r','Xinxiang_r','Qiqihar_r','Zibo_r','Sanya_r','Zhuzhou_r','Jining_r','Shangqiu_r','Yinchuan_r','Dali_Bai_Autonomous_Prefecture_r','Jinzhou_r','Zhaoqing_r','Daqing_r','Yueyang_r','Lianyungang_r','Xining_r','Xianyang_r','Dandong_r','Tongliao_r','Changde_r','Zunyi_r','Nanyang_r','Putian_r','Suqian_r','Chifeng_r','Jiujiang_r','Cangzhou_r','Nanchong_r','Handan_r','Yingkou_r','Fuyang_r','Xinyang_r','Weihai_r','Hulunbeir_r','Deyang_r','Xiangtan_r','Maanshan_r','Anqing_r','Luzhou_r','Panjin_r','Yibin_r','Shangrao_r','Xiangyang_r','Quzhou_r','Yuncheng_r','Lu_an_r','Bengbu_r','Jingzhou_r','Kaifeng_r','Zhoukou_r','Leshan_r','Tai_an_r','Chuzhou_r','Xuchang_r','Huludao_r','Fushun_r','Siping_r','Zhumadian_r','Jieyang_r','Qingyuan_r','Suihua_r','Huanggang_r','Zhangjiakou_r','Huaihua_r','Xiaogan_r','Maoming_r','Anyang_r','Tieling_r','Datong_r','Liaoyang_r','Beihai_r','Lishui_r','Jiaozuo_r','Heze_r','Chenzhou_r','Honghe_Hani_and_Yi_Autonomous_Prefecture_r','Longyan_r','Songyuan_r','Xingtai_r','Ningde_r','Chaozhou_r','Qujing_r','Chengde_r','Liaocheng_r','Pingdingshan_r','Nanping_r','Yangjiang_r','Suining_r','Shaoyang_r','Shaoguan_r','Meizhou_r','Jinzhong_r','Rizhao_r','Lhasa_r','Yichun_jiangxi_r','Dezhou_r','Dongying_r','Yongzhou_r','Chaoyang_r','Tonghua_r','Meishan_r','Minnan_Buyi_and_Miao_Autonomous_Prefecture_r','Yulin_shanxi_r','Mudanjiang_r','Haozhou_r','Luohe_r','Jiamusi_r','Yiyang_r','Yuxi_r','Linfen_r','Weinan_r','Ji_an_r','Baicheng_r','Xuancheng_r','Benxi_r','Baoji_r','Liangshan_Yi_Autonomous_Prefecture_r','Shanwei_r','Sanming_r','Neijiang_r','Jingmen_r','Suzhou_anhui_r','Tongren_r','Bayin_Guoyu_Mongolian_Autonomous_Prefecture_r','Fuzhou_jiangxi_r','Xiangxi_Tujia_and_Miao_Autonomous_Prefecture_r','Dazhou_r','Xing_an_League_r','Loudi_r','Zaozhuang_r','Anshun_r','Huangshan_r','Ordos_r','Hanzhong_r','Huangshi_r','Southeast_Guizhou_Miao_and_Dong_Autonomous_Prefecture_r','Fuxin_r','Yulin_guangxi_r','Baishan_r','Xianning_r','Puyang_r','Binzhou_r','Lijiang_r','Bijie_r','Changji_Hui_Autonomous_Prefecture_r','Zigong_r','Wuzhou_r','Chizhou_r','Tongling_r','Wenshan_Zhuang_and_Miao_Autonomous_Prefecture_r','Hengshui_r','Pu_er_r','Southwest_Guizhou_Buyi_and_Miao_Autonomous_Prefecture_r','Huaibei_r','Baise_r','Heyuan_r','Enshi_Tujia_and_Miao_Autonomous_Prefecture_r','Huainan_r','Bayannaoer_r','Shiyan_r','Xilin_Gol_League_r','Ziyang_r','Bazhong_r','Zhoushan_r','Jingdezhen_r','Qinzhou_r','Sanmenxia_r','Changzhi_r','Wulanchabu_r','Linzhi_r','Zhaotong_r','Liupanshui_r','Shihezi_r','Zhangjiajie_r','Guangyuan_r','Chuxiong_Yi_Autonomous_Prefecture_r','Ankang_r','Ili_Kazakh_Autonomous_Prefecture_r','Jixi_r','Yunfu_r','Jiuquan_r','Wuzhong_r','Dehong_Dai_Jingpo_Autonomous_Prefecture_r','Baoshan_r','Luliang_r','Aksu_area_r','Hechi_r','Guigang_r','Guang_an_r','Xinzhou_r','Xishuangbanna_Dai_Autonomous_Prefecture_r','Heihe_r','Yan_an_r','Xinyu_r','Chongzuo_r','Panzhihua_r','Ezhou_r','Fangchenggang_r','Hebi_r','Yangquan_r','Ya_an_r','Wuhai_r','Jincheng_r','Liaoyuan_r','Shuangyashan_r','Danzhou_r','Yingtan_r','Pingxiang_r','Hami_r','Karamay_r','Lincang_r','Suizhou_r','Shuozhou_r','Tacheng_area_r','Dingxi_r','Kashgar_r','Qionghai_r','Yichun_heilongjiang_r','Laibin_r','Tianshui_r','Laiwu_r','Hezhou_r','Qingyang_r','Qitaihe_r','Shizuishan_r','Jiayuguan_r','Xiantao_r','Bortala_Mongolian_Autonomous_Prefecture_r','Wuwei_r','Haixi_Mongolian_Tibetan_Autonomous_Prefecture_r','Pingliang_r','Tulufan_r','Baiyin_r','Zhongwei_r','Tianmen_r','Shangluo_r','Haidong_r','Jiyuan_r','Qianjiang_r','Linxia_Hui_Autonomous_Prefecture_r','Longnan_r','Aba_Tibetan_and_Qiang_Autonomous_Prefecture_r','Jinchang_r','Zhangye_r','Guyuan_r','Alxa_League_r','Rikaze_r','Hegang_r','Dongfang_r','Wenchang_r','Hotan_area_r','Wanning_r','Diqing_Tibetan_Autonomous_Prefecture_r','Ganzi_Tibetan_Autonomous_Prefecture_r','Linshui_Lizu_Autonomous_Prefecture_r','Shannan_r','Hainan_Tibetan_Autonomous_Prefecture_r','Tongchuan_r','Altay_area_r','Changjiang_Lizu_Autonomus_Prefecture_r','Chengmai_r','Changdu_r','Alaer_r','Nagqu_area_r','Wujiaqu_r','Nujiang_Yi_Autonomous_Prefecture_r','Beitun_r','Kizilsu_Kirghiz_Autonomous_Prefecture_r','Ledong_Lizu_Autonomous_Prefecture_r','Ali_area_r','Lingao_r','Daxinganling_area_r','Wuzhishan_r','Gannan_Tibetan_Autonomous_Prefecture_r','Qiongzhong_Lizu_Miaozu_Autonomous_Prefecture_r','Baoting_Lizu_Miaozu_Autonomous_Prefecture_r','Tunchang_r','Huangnan_Tibetan_Autonomous_Prefecture_r','Anding_r','Yushu_Tibetan_Autonomous_Prefecture_r','Basha_Lizu_Autonomous_Prefecture_r','Haibei_Tibetan_Autonomous_Prefecture_r','Shennongjia_Forrest_r','shuanghe_r','xinjiang_autonomous_districts_r','Hebei','Shanxi','Liaoning','Jilin_1','Heilongjiang','Jiangsu','Zhejiang','Anhui','Fujian','Jiangxi','Shandong','Henan','Hubei','Hunan','Guangdong','Hainan','Sichuan','Guizhou','Yunnan','Shaanxi','Gansu','Qinghai','Neimenggu','Guangxi','Xizang','Ningxia','Xinjiang','total_store','total_store_r','Hebei_r','Shanxi_r','Liaoning_r','Jilin_1_r','Heilongjiang_r','Jiangsu_r','Zhejiang_r','Anhui_r','Fujian_r','Jiangxi_r','Shandong_r','Henan_r','Hubei_r','Hunan_r','Guangdong_r','Hainan_r','Sichuan_r','Guizhou_r','Yunnan_r','Shaanxi_r','Gansu_r','Qinghai_r','Neimenggu_r','Guangxi_r','Xizang_r','Ningxia_r','Xinjiang_r'
    )=1;
```





### 2、 更新excel

```sql
with t1 as (
select distinct deptid::text as shopid from luckin.ods_shops_new where ts_string='2020-03-01')
select shopid,name,replace(replace(number,'(',''),')',''),j4.city,city_tier,gcjlat,gcjlon,decode((substring((shoplogo) from 'CtQL.*'))::text, 'CtQLO101jXyAffZ4AAAWeg_Jbn8375.png',
                                       'flash', 'CtQLO101jZ2AZ6PQAAAWvqEqU4k138.png', 'pickup',
                                       'CtQLO1031TSAeU_QAAAS-zDqTB0498.png', 'openingsoon',
                                       'CtQLPF01jdKAXIRRAAAXNh2zxNc819.png', 'relax',
                                       'CtQLO101jOiADegnAAAXE1MCtQk781.png', 'express','CtQyFV4fxHCAAturAAAPBmH50Fo271.png','mini', '') as types,
      case when  number ilike '%No.MT%' then '实验店'
when name like '%测试%' then '实验店'
when name like '%厨房%' then '外卖厨房'
when number ilike '%No.C%' then '小鹿茶代运营'
when number ilike '%No.LX%' then '培训教室'
when number ilike '%No.B%' then '小鹿茶自营'
when number ilike '%No.ZLX%' then '鹿茶培训'
when number ilike '%No.ZXL%' then '咖啡培训'
when number ilike '%No.A%' then '瑞幸咖啡代运营'
when number ilike '%no.T%' then '外卖厨房'
when number ilike '%no.KS%' then '快闪店'
when number ilike '%No.dyysyd%' then '代运营实验店'
when number ilike '%No.SYD%' then '实验店'
when number ilike '%No.RJGBJSYD%' then '实验店'
when number ilike '%No.Perf%' then '压测店'
when number ilike '%No.PX%' then '培训教室'
when number ilike '%No.PJ%' then '品鉴活动'
when number ilike '%No.RJGXMSYD%' then '实验店'
when number ~ E'No\\.\\d' then '瑞幸咖啡自营'
else '' end as typess,worktime,address from t1 left join (select distinct on(shopid) *
from luckin.ods_shops_detail order by shopid,ts_string desc,length(address) desc) xx using(shopid)
left join luckin.dw_shop_city j3 using(shopid)
left join luckin.std_city j4 on j3.cityname=replace(j4.city,'市','');
```